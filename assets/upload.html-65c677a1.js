import{_ as l}from"./plugin-vue_export-helper-c27b6911.js";import{r as e,o as c,c as i,a,b as n,e as s,w as u,d as p}from"./app-531015dd.js";const r="/ddtd-doc/assets/image/upload-image.png",d="/ddtd-doc/assets/image/upload-attachment.png",k={},m=a("h2",{id:"文件上传配置",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#文件上传配置","aria-hidden":"true"},"#"),n(" 文件上传配置")],-1),v=a("p",null,[n("文件上传配置，在 "),a("code",null,"系统管理"),n(" -> "),a("code",null,"系统配置"),n(" -> "),a("code",null,"文件上传"),n(" 中配置。")],-1),g=a("p",null,"目前支持以下方式:",-1),h=a("li",null,"ucloud",-1),b=a("li",null,"腾讯云 COS",-1),q=a("li",null,"阿里云 OSS",-1),_=a("li",null,"七牛云",-1),f=p('<h2 id="上传单个图片" tabindex="-1"><a class="header-anchor" href="#上传单个图片" aria-hidden="true">#</a> 上传单个图片</h2><h3 id="示例" tabindex="-1"><a class="header-anchor" href="#示例" aria-hidden="true">#</a> 示例</h3><figure><img src="'+r+`" alt="上传单个图片" tabindex="0" loading="lazy"><figcaption>上传单个图片</figcaption></figure><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>网站logo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>basicLogo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">help</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>d-upload-image</span> <span class="token attr-name"><span class="token namespace">v-model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>formData.basicLogo<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-form-item</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="详细介绍" tabindex="-1"><a class="header-anchor" href="#详细介绍" aria-hidden="true">#</a> 详细介绍</h3><h4 id="配置项" tabindex="-1"><a class="header-anchor" href="#配置项" aria-hidden="true">#</a> 配置项:</h4><ul><li>value <ul><li>类型: <code>string</code></li><li>说明: 文件上传地址</li></ul></li></ul><h2 id="上传多个附件" tabindex="-1"><a class="header-anchor" href="#上传多个附件" aria-hidden="true">#</a> 上传多个附件</h2><h3 id="示例-1" tabindex="-1"><a class="header-anchor" href="#示例-1" aria-hidden="true">#</a> 示例</h3><figure><img src="`+d+`" alt="上传附件" tabindex="0" loading="lazy"><figcaption>上传附件</figcaption></figure><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>附件上传<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileIds<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>d-upload-attachment</span> <span class="token attr-name"><span class="token namespace">v-model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileIds<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:init-attachments</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>initAttachList<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-form-item</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> type <span class="token punctuation">{</span> AttachmentRes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/api/apply/attachmentModel&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fileIds <span class="token operator">=</span> ref<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 也可由后端传值</span>
<span class="token keyword">const</span> initAttaList <span class="token operator">=</span> ref<span class="token operator">&lt;</span>AttachmentRes<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">userId</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">drive</span><span class="token operator">:</span> <span class="token string">&quot;minio&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;dffacb18-9730-4e06-919c-6fc3ab2bce5f.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">kind</span><span class="token operator">:</span> <span class="token string">&quot;image&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">mimeType</span><span class="token operator">:</span> <span class="token string">&quot;image/jpeg&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;ddtd/attachment/2023-09-15/cvj5u1835qzkegwcwe.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">fileUrl</span><span class="token operator">:</span> <span class="token string">&quot;ddtd/attachment/2023-09-15/cvj5u1835qzkegwcwe.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">24586</span><span class="token punctuation">,</span>
    <span class="token literal-property property">ext</span><span class="token operator">:</span> <span class="token string">&quot;jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">md5</span><span class="token operator">:</span> <span class="token string">&quot;4fbb68c6a0da9306cd41598fd822fb3e&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sizeFormat</span><span class="token operator">:</span> <span class="token string">&quot;24.01KB&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createdAt</span><span class="token operator">:</span> <span class="token string">&quot;2021-09-15 09:25:05&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">updatedAt</span><span class="token operator">:</span> <span class="token string">&quot;2021-09-15 09:25:05&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),y={class:"hint-container warning"},x=a("p",{class:"hint-container-title"},"注意",-1),w=a("code",null,"init-attachments",-1),A=a("br",null,null,-1),E=p(`<h3 id="详细介绍-1" tabindex="-1"><a class="header-anchor" href="#详细介绍-1" aria-hidden="true">#</a> 详细介绍</h3><h4 id="配置项-1" tabindex="-1"><a class="header-anchor" href="#配置项-1" aria-hidden="true">#</a> 配置项</h4><ul><li>value <ul><li>类型: <code>string</code></li><li>说明: 存储附件 id，以 <code>,</code> 隔开。</li></ul></li><li>initAttachments <ul><li>类型: <code>AttachmentRes[]</code></li><li>说明: 初始化附件，一般由后端构造好返回。</li></ul></li><li>maxCount <ul><li>类型: <code>number</code></li><li>说明: 最大上传个数，默认 2。</li></ul></li><li>disabled <ul><li>类型: <code>boolean</code></li><li>说明: 不可编辑</li></ul></li></ul><h2 id="更多" tabindex="-1"><a class="header-anchor" href="#更多" aria-hidden="true">#</a> 更多</h2><h3 id="附件路径补全" tabindex="-1"><a class="header-anchor" href="#附件路径补全" aria-hidden="true">#</a> 附件路径补全</h3><p>因为路径都是相对路径，在前端展示文件的时候，需要将路径补全。</p><ul><li>配置 <code>VITE_FILE_URL_PREFIX</code> 环境变量。</li></ul><div class="language-env line-numbers-mode" data-ext="env"><pre class="language-env"><code>VITE_FILE_URL_PREFIX = http://218.76.52.126:9000/ddpmz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>调用 <code>getFileAbsUrl</code> 方法来补全路径。</li></ul><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-avatar</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getFileAbsUrl(loginUser?.avatar)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> getFileAbsUrl <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils&#39;</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,10);function I(L,j){const t=e("Badge"),o=e("RouterLink");return c(),i("div",null,[m,v,g,a("ul",null,[a("li",null,[n("本地存储 "),s(t,{text:"推荐",type:"success"})]),a("li",null,[n("minio "),s(t,{text:"推荐",type:"success"})]),h,b,q,_]),f,a("div",y,[x,a("p",null,[w,n(" 一般由后端构造好返回。"),A,s(o,{to:"/backend/component/upload.html#%E9%99%84%E4%BB%B6%E8%A7%A3%E6%9E%90"},{default:u(()=>[n("附件解析")]),_:1})])]),E])}const F=l(k,[["render",I],["__file","upload.html.vue"]]);export{F as default};
